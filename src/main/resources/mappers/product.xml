<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.project.stussy.domain.product.ProductRepository">
  		<insert id="saveProduct" parameterType="com.project.stussy.domain.product.Product"
  			useGeneratedKeys="true" keyProperty="product_code">
  			insert into
  				product_mst
  			values(
  					0,
  			#{product_category},
			#{product_name},
			#{product_price},
			#{product_explanation},
			#{product_size},
			#{product_count},
			now(),
			now()
  			)
  		</insert>
  		
  		<insert id="saveProductFiles" parameterType="java.util.List">
  			insert into
  				product_file
  			values
  				<foreach collection="list" item="file" separator=",">
  					(
  						0,
  						#{file.product_code},
  						#{file.file_name},
  						now(),
  						now()
  					)
  				</foreach>
  		</insert>
  	
  		
  		<select id="getProductList" parameterType="hashmap" resultType="com.project.stussy.domain.product.Product">
  				SELECT
					pm.product_code,
					pf.file_name,
					pm.product_category,
					pm.product_name,
					pm.product_price,
					pm.product_size,
					pm.product_explanation
				
				FROM
					product_mst pm
					LEFT OUTER JOIN product_file pf ON(pf.product_code = pm.product_code)
			order by
				product_code asc
			limit #{index}, 10;		
  		</select>
  		
  		<select id="getProductDetail" parameterType="Integer" resultType="com.project.stussy.domain.product.Product">
  			SELECT	
  			pm.product_code,
			pm.product_category,
			pm.product_size,
			pm.product_name,
			pm.product_price,
			pm.product_explanation,
			pf.file_name
		
		FROM
			product_mst pm
			LEFT OUTER JOIN product_file pf ON(pf.product_code = pm.product_code)
		where
			pm.product_code = #{product_code};
						
  		</select>
  		
  		
	<update id="updateProduct" parameterType="com.project.stussy.domain.product.Product">
		update
			product_mst pm
			left outer join product_file pf on(pf.product_code = pm.product_code)
		set
			pm.product_code = #{product_code},
			pm.product_category = #{product_category},
			pm.product_name = #{product_name},
			pm.product_price = #{product_price},
			pm.product_explanation = #{product_explanation},
			pm.product_size = #{product_size},
			pf.file_name = #{file_name}
		where
			pm.product_code = #{product_code}	
	</update>
	
	<delete id="deleteProduct" parameterType="Integer">
		delete
		from
			product_mst
		where
			product_code = #{product_code}
	</delete>
  		
  		
  </mapper>